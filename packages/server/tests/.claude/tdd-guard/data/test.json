{
  "testModules": [
    {
      "moduleId": "/Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts",
      "tests": [
        {
          "name": "should create a compiled graph",
          "fullName": "Orchestrator Graph > createOrchestratorGraph > should create a compiled graph",
          "state": "passed"
        },
        {
          "name": "should log graph creation with model configuration",
          "fullName": "Orchestrator Graph > createOrchestratorGraph > should log graph creation with model configuration",
          "state": "passed"
        },
        {
          "name": "should route to A3 when peer efficiency > user efficiency",
          "fullName": "Orchestrator Graph > Routing Decision > should route to A3 when peer efficiency > user efficiency",
          "state": "passed"
        },
        {
          "name": "should route to A4-Web when user has opportunities",
          "fullName": "Orchestrator Graph > Routing Decision > should route to A4-Web when user has opportunities",
          "state": "passed"
        },
        {
          "name": "should route to A4-Company when company docs enabled",
          "fullName": "Orchestrator Graph > Routing Decision > should route to A4-Company when company docs enabled",
          "state": "failed",
          "errors": [
            {
              "message": "expected [ 'A5_FEATURE_ADOPTION', 'A4_WEB' ] to include 'A4_COMPANY'",
              "stack": "AssertionError: expected [ 'A5_FEATURE_ADOPTION', 'A4_WEB' ] to include 'A4_COMPANY'\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1191:15)\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/chai@5.3.3/node_modules/chai/index.js:1686:25)\n    at /Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts:309:51\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20",
              "expected": "undefined",
              "actual": "Array [\n  \"A5_FEATURE_ADOPTION\",\n  \"A4_WEB\",\n]"
            },
            {
              "message": "expected [ 'A5_FEATURE_ADOPTION', 'A4_WEB' ] to include 'A4_COMPANY'",
              "stack": "AssertionError: expected [ 'A5_FEATURE_ADOPTION', 'A4_WEB' ] to include 'A4_COMPANY'\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1191:15)\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/chai@5.3.3/node_modules/chai/index.js:1686:25)\n    at /Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts:309:51\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20",
              "expected": "undefined",
              "actual": "Array [\n  \"A5_FEATURE_ADOPTION\",\n  \"A4_WEB\",\n]"
            }
          ]
        },
        {
          "name": "should fallback to A4-Web when no peer data",
          "fullName": "Orchestrator Graph > Routing Decision > should fallback to A4-Web when no peer data",
          "state": "failed",
          "errors": [
            {
              "message": "expected 'User data available for feature disco…' to contain 'No peer data'",
              "stack": "AssertionError: expected 'User data available for feature disco…' to contain 'No peer data'\n    at /Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts:329:46\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20",
              "expected": "No peer data",
              "actual": "User data available for feature discovery analysis (PRIORITY); Peer data available (1 workflows); Web search as fallback (only 0 user analysis results); User data: 0 workflows, 1 sessions"
            },
            {
              "message": "expected 'User data available for feature disco…' to contain 'No peer data'",
              "stack": "AssertionError: expected 'User data available for feature disco…' to contain 'No peer data'\n    at /Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts:329:46\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20",
              "expected": "No peer data",
              "actual": "User data available for feature discovery analysis (PRIORITY); Peer data available (1 workflows); Web search as fallback (only 0 user analysis results); User data: 0 workflows, 1 sessions"
            }
          ]
        },
        {
          "name": "should log routing decision",
          "fullName": "Orchestrator Graph > Routing Decision > should log routing decision",
          "state": "failed",
          "errors": [
            {
              "message": "expected \"spy\" to be called with arguments: [ Array(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating Orchestrator Graph\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"modelConfiguration\": {\u001b[90m\n\u001b[31m+       \"A1_RETRIEVAL\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A2_JUDGE\": \"openai/gpt-4o (temp=0.1)\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  2nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A1 Retrieval Agent\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"hasPersonas\": false,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  3rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating A1 Retrieval Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  4th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  5th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  6th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  7th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  8th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  9th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  10th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  11th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  12th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  13th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  14th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  15th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  16th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  17th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  18th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  19th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  20th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  21st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  22nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  23rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  24th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  25th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  26th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  27th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  28th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  29th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  30th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  31st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  32nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  33rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  34th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A1 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": false,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 16,\u001b[90m\n\u001b[31m+     \"hasPeerEvidence\": true,\u001b[90m\n\u001b[31m+     \"hasUserEvidence\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  35th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A2 Judge Agent\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  36th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating A2 Judge Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  37th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing user workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  38th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing peer workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  39th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting inefficiency identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  40th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Identifying opportunities\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasInefficiencies\": false,\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowName\": \"research workflow pattern\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  41st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting opportunity identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  42nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Peer diagnostics complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"efficiencyScore\": 100,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  43rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  44th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"errorCount\": 0,\u001b[90m\n\u001b[31m+     \"passed\": true,\u001b[90m\n\u001b[31m+     \"warningCount\": 1,\u001b[90m\n\u001b[31m+     \"wasAutoFixed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  45th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": true,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 5,\u001b[90m\n\u001b[31m+     \"hasPeerDiagnostics\": true,\u001b[90m\n\u001b[31m+     \"hasUserDiagnostics\": false,\u001b[90m\n\u001b[31m+     \"peerEfficiency\": 100,\u001b[90m\n\u001b[31m+     \"userEfficiency\": undefined,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  46th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 Opportunity Debug\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencies\": [],\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"opportunities\": [],\u001b[90m\n\u001b[31m+     \"opportunityCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  47th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Making combined routing decision\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  48th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Routing decision made\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"reasons\": [\u001b[90m\n\u001b[31m+       \"User data available for feature discovery analysis (PRIORITY)\",\u001b[90m\n\u001b[31m+       \"Peer data available (1 workflows)\",\u001b[90m\n\u001b[31m+       \"Web search as fallback (only 0 user analysis results)\",\u001b[90m\n\u001b[31m+       \"User data: 0 workflows, 1 sessions\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  49th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Executing downstream agents IN PARALLEL\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"modelConfig\": {\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  50th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  51st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting web search for user query (parallel with agents)\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  52nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: All downstream agents + web search + feature adoption completed in parallel\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentCount\": 2,\u001b[90m\n\u001b[31m+     \"agentNames\": [\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"hasWebSearchResult\": false,\u001b[90m\n\u001b[31m+     \"parallelDurationMs\": 107,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  53rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Merging results and applying thresholds\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  54th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Available optimization plans\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"companyBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"companyPlanExists\": false,\u001b[90m\n\u001b[31m+     \"peerBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"peerPlanExists\": true,\u001b[90m\n\u001b[31m+     \"webBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"webPlanExists\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  55th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Plans after filtering nulls\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"planCount\": 2,\u001b[90m\n\u001b[31m+     \"totalBlocksBeforeMerge\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  56th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating user query answer\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  57th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  58th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting user query answer LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  59th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  60th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Query type detected\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasWorkflowContext\": false,\u001b[90m\n\u001b[31m+     \"isKnowledgeQuery\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  61st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting follow-up questions LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  62nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Follow-up questions generated\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"attempts\": 2,\u001b[90m\n\u001b[31m+     \"count\": 0,\u001b[90m\n\u001b[31m+     \"questions\": [],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  63rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Using fallback follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  64th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Finalization complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"answerGenerationMs\": 105,\u001b[90m\n\u001b[31m+     \"blockCount\": 0,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 106,\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"followUpGenerationMs\": 1,\u001b[90m\n\u001b[31m+     \"passesThreshold\": false,\u001b[90m\n\u001b[31m+     \"totalTimeSaved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m64\u001b[22m\n\u001b[39m",
              "stack": "AssertionError: expected \"spy\" to be called with arguments: [ Array(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating Orchestrator Graph\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"modelConfiguration\": {\u001b[90m\n\u001b[31m+       \"A1_RETRIEVAL\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A2_JUDGE\": \"openai/gpt-4o (temp=0.1)\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  2nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A1 Retrieval Agent\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"hasPersonas\": false,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  3rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating A1 Retrieval Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  4th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  5th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  6th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  7th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  8th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  9th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  10th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  11th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  12th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  13th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  14th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  15th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  16th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  17th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  18th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  19th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  20th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  21st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  22nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  23rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  24th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  25th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  26th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  27th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  28th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  29th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  30th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  31st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  32nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  33rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  34th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A1 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": false,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 16,\u001b[90m\n\u001b[31m+     \"hasPeerEvidence\": true,\u001b[90m\n\u001b[31m+     \"hasUserEvidence\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  35th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A2 Judge Agent\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  36th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating A2 Judge Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  37th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing user workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  38th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing peer workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  39th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting inefficiency identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  40th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Identifying opportunities\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasInefficiencies\": false,\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowName\": \"research workflow pattern\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  41st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting opportunity identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  42nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Peer diagnostics complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"efficiencyScore\": 100,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  43rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  44th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"errorCount\": 0,\u001b[90m\n\u001b[31m+     \"passed\": true,\u001b[90m\n\u001b[31m+     \"warningCount\": 1,\u001b[90m\n\u001b[31m+     \"wasAutoFixed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  45th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": true,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 5,\u001b[90m\n\u001b[31m+     \"hasPeerDiagnostics\": true,\u001b[90m\n\u001b[31m+     \"hasUserDiagnostics\": false,\u001b[90m\n\u001b[31m+     \"peerEfficiency\": 100,\u001b[90m\n\u001b[31m+     \"userEfficiency\": undefined,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  46th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 Opportunity Debug\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencies\": [],\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"opportunities\": [],\u001b[90m\n\u001b[31m+     \"opportunityCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  47th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Making combined routing decision\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  48th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Routing decision made\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"reasons\": [\u001b[90m\n\u001b[31m+       \"User data available for feature discovery analysis (PRIORITY)\",\u001b[90m\n\u001b[31m+       \"Peer data available (1 workflows)\",\u001b[90m\n\u001b[31m+       \"Web search as fallback (only 0 user analysis results)\",\u001b[90m\n\u001b[31m+       \"User data: 0 workflows, 1 sessions\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  49th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Executing downstream agents IN PARALLEL\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"modelConfig\": {\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  50th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  51st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting web search for user query (parallel with agents)\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  52nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: All downstream agents + web search + feature adoption completed in parallel\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentCount\": 2,\u001b[90m\n\u001b[31m+     \"agentNames\": [\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"hasWebSearchResult\": false,\u001b[90m\n\u001b[31m+     \"parallelDurationMs\": 107,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  53rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Merging results and applying thresholds\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  54th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Available optimization plans\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"companyBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"companyPlanExists\": false,\u001b[90m\n\u001b[31m+     \"peerBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"peerPlanExists\": true,\u001b[90m\n\u001b[31m+     \"webBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"webPlanExists\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  55th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Plans after filtering nulls\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"planCount\": 2,\u001b[90m\n\u001b[31m+     \"totalBlocksBeforeMerge\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  56th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating user query answer\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  57th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  58th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting user query answer LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  59th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  60th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Query type detected\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasWorkflowContext\": false,\u001b[90m\n\u001b[31m+     \"isKnowledgeQuery\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  61st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting follow-up questions LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  62nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Follow-up questions generated\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"attempts\": 2,\u001b[90m\n\u001b[31m+     \"count\": 0,\u001b[90m\n\u001b[31m+     \"questions\": [],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  63rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Using fallback follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  64th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Finalization complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"answerGenerationMs\": 105,\u001b[90m\n\u001b[31m+     \"blockCount\": 0,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 106,\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"followUpGenerationMs\": 1,\u001b[90m\n\u001b[31m+     \"passesThreshold\": false,\u001b[90m\n\u001b[31m+     \"totalTimeSaved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m64\u001b[22m\n\u001b[39m\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1355:10)\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/chai@5.3.3/node_modules/chai/index.js:1686:25)\n    at /Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts:346:31\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"
            },
            {
              "message": "expected \"spy\" to be called with arguments: [ Array(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating Orchestrator Graph\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"modelConfiguration\": {\u001b[90m\n\u001b[31m+       \"A1_RETRIEVAL\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A2_JUDGE\": \"openai/gpt-4o (temp=0.1)\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  2nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A1 Retrieval Agent\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"hasPersonas\": false,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  3rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating A1 Retrieval Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  4th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  5th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  6th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  7th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  8th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  9th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  10th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  11th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  12th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  13th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  14th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  15th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  16th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  17th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  18th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  19th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  20th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  21st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  22nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  23rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  24th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  25th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  26th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  27th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  28th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  29th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  30th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  31st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  32nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  33rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  34th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A1 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": false,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 8,\u001b[90m\n\u001b[31m+     \"hasPeerEvidence\": true,\u001b[90m\n\u001b[31m+     \"hasUserEvidence\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  35th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A2 Judge Agent\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  36th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating A2 Judge Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  37th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing user workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  38th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing peer workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  39th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting inefficiency identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  40th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Identifying opportunities\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasInefficiencies\": false,\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowName\": \"research workflow pattern\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  41st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting opportunity identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  42nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Peer diagnostics complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"efficiencyScore\": 100,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  43rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  44th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"errorCount\": 0,\u001b[90m\n\u001b[31m+     \"passed\": true,\u001b[90m\n\u001b[31m+     \"warningCount\": 1,\u001b[90m\n\u001b[31m+     \"wasAutoFixed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  45th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": true,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 3,\u001b[90m\n\u001b[31m+     \"hasPeerDiagnostics\": true,\u001b[90m\n\u001b[31m+     \"hasUserDiagnostics\": false,\u001b[90m\n\u001b[31m+     \"peerEfficiency\": 100,\u001b[90m\n\u001b[31m+     \"userEfficiency\": undefined,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  46th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 Opportunity Debug\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencies\": [],\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"opportunities\": [],\u001b[90m\n\u001b[31m+     \"opportunityCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  47th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Making combined routing decision\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  48th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Routing decision made\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"reasons\": [\u001b[90m\n\u001b[31m+       \"User data available for feature discovery analysis (PRIORITY)\",\u001b[90m\n\u001b[31m+       \"Peer data available (1 workflows)\",\u001b[90m\n\u001b[31m+       \"Web search as fallback (only 0 user analysis results)\",\u001b[90m\n\u001b[31m+       \"User data: 0 workflows, 1 sessions\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  49th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Executing downstream agents IN PARALLEL\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"modelConfig\": {\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  50th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  51st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting web search for user query (parallel with agents)\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  52nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: All downstream agents + web search + feature adoption completed in parallel\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentCount\": 2,\u001b[90m\n\u001b[31m+     \"agentNames\": [\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"hasWebSearchResult\": false,\u001b[90m\n\u001b[31m+     \"parallelDurationMs\": 130,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  53rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Merging results and applying thresholds\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  54th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Available optimization plans\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"companyBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"companyPlanExists\": false,\u001b[90m\n\u001b[31m+     \"peerBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"peerPlanExists\": true,\u001b[90m\n\u001b[31m+     \"webBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"webPlanExists\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  55th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Plans after filtering nulls\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"planCount\": 2,\u001b[90m\n\u001b[31m+     \"totalBlocksBeforeMerge\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  56th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating user query answer\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  57th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  58th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting user query answer LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  59th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  60th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Query type detected\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasWorkflowContext\": false,\u001b[90m\n\u001b[31m+     \"isKnowledgeQuery\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  61st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting follow-up questions LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  62nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Follow-up questions generated\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"attempts\": 2,\u001b[90m\n\u001b[31m+     \"count\": 0,\u001b[90m\n\u001b[31m+     \"questions\": [],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  63rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Using fallback follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  64th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Finalization complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"answerGenerationMs\": 119,\u001b[90m\n\u001b[31m+     \"blockCount\": 0,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 120,\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"followUpGenerationMs\": 1,\u001b[90m\n\u001b[31m+     \"passesThreshold\": false,\u001b[90m\n\u001b[31m+     \"totalTimeSaved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m64\u001b[22m\n\u001b[39m",
              "stack": "AssertionError: expected \"spy\" to be called with arguments: [ Array(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating Orchestrator Graph\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"modelConfiguration\": {\u001b[90m\n\u001b[31m+       \"A1_RETRIEVAL\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A2_JUDGE\": \"openai/gpt-4o (temp=0.1)\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  2nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A1 Retrieval Agent\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"hasPersonas\": false,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  3rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating A1 Retrieval Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  4th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  5th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  6th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  7th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  8th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  9th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  10th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  11th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  12th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  13th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  14th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  15th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  16th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  17th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  18th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  19th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  20th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  21st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  22nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  23rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  24th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  25th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  26th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  27th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  28th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  29th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  30th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  31st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  32nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  33rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  34th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A1 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": false,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 8,\u001b[90m\n\u001b[31m+     \"hasPeerEvidence\": true,\u001b[90m\n\u001b[31m+     \"hasUserEvidence\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  35th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A2 Judge Agent\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  36th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Creating A2 Judge Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  37th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing user workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  38th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing peer workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  39th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting inefficiency identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  40th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Identifying opportunities\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasInefficiencies\": false,\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowName\": \"research workflow pattern\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  41st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting opportunity identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  42nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Peer diagnostics complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"efficiencyScore\": 100,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  43rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  44th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"A2: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"errorCount\": 0,\u001b[90m\n\u001b[31m+     \"passed\": true,\u001b[90m\n\u001b[31m+     \"warningCount\": 1,\u001b[90m\n\u001b[31m+     \"wasAutoFixed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  45th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": true,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 3,\u001b[90m\n\u001b[31m+     \"hasPeerDiagnostics\": true,\u001b[90m\n\u001b[31m+     \"hasUserDiagnostics\": false,\u001b[90m\n\u001b[31m+     \"peerEfficiency\": 100,\u001b[90m\n\u001b[31m+     \"userEfficiency\": undefined,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  46th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 Opportunity Debug\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencies\": [],\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"opportunities\": [],\u001b[90m\n\u001b[31m+     \"opportunityCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  47th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Making combined routing decision\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  48th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Routing decision made\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"reasons\": [\u001b[90m\n\u001b[31m+       \"User data available for feature discovery analysis (PRIORITY)\",\u001b[90m\n\u001b[31m+       \"Peer data available (1 workflows)\",\u001b[90m\n\u001b[31m+       \"Web search as fallback (only 0 user analysis results)\",\u001b[90m\n\u001b[31m+       \"User data: 0 workflows, 1 sessions\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  49th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Executing downstream agents IN PARALLEL\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"modelConfig\": {\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  50th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  51st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting web search for user query (parallel with agents)\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  52nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: All downstream agents + web search + feature adoption completed in parallel\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentCount\": 2,\u001b[90m\n\u001b[31m+     \"agentNames\": [\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"hasWebSearchResult\": false,\u001b[90m\n\u001b[31m+     \"parallelDurationMs\": 130,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  53rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Merging results and applying thresholds\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  54th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Available optimization plans\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"companyBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"companyPlanExists\": false,\u001b[90m\n\u001b[31m+     \"peerBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"peerPlanExists\": true,\u001b[90m\n\u001b[31m+     \"webBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"webPlanExists\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  55th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Plans after filtering nulls\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"planCount\": 2,\u001b[90m\n\u001b[31m+     \"totalBlocksBeforeMerge\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  56th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating user query answer\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  57th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  58th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting user query answer LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  59th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  60th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Query type detected\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasWorkflowContext\": false,\u001b[90m\n\u001b[31m+     \"isKnowledgeQuery\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  61st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting follow-up questions LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  62nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Follow-up questions generated\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"attempts\": 2,\u001b[90m\n\u001b[31m+     \"count\": 0,\u001b[90m\n\u001b[31m+     \"questions\": [],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  63rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Using fallback follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  64th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Routing Decision) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Finalization complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"answerGenerationMs\": 119,\u001b[90m\n\u001b[31m+     \"blockCount\": 0,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 120,\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"followUpGenerationMs\": 1,\u001b[90m\n\u001b[31m+     \"passesThreshold\": false,\u001b[90m\n\u001b[31m+     \"totalTimeSaved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m64\u001b[22m\n\u001b[39m\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1355:10)\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/chai@5.3.3/node_modules/chai/index.js:1686:25)\n    at /Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts:346:31\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"
            }
          ]
        },
        {
          "name": "should pass threshold when savings >= 10 minutes",
          "fullName": "Orchestrator Graph > Quality Thresholds > should pass threshold when savings >= 10 minutes",
          "state": "passed"
        },
        {
          "name": "should pass threshold when relative improvement >= 40%",
          "fullName": "Orchestrator Graph > Quality Thresholds > should pass threshold when relative improvement >= 40%",
          "state": "passed"
        },
        {
          "name": "should produce final result with executive summary",
          "fullName": "Orchestrator Graph > Final Result > should produce final result with executive summary",
          "state": "passed"
        },
        {
          "name": "should produce final optimized workflow",
          "fullName": "Orchestrator Graph > Final Result > should produce final optimized workflow",
          "state": "passed"
        },
        {
          "name": "should include executive summary in final result",
          "fullName": "Orchestrator Graph > Final Result > should include executive summary in final result",
          "state": "passed"
        },
        {
          "name": "should include suggested follow-ups in final result",
          "fullName": "Orchestrator Graph > Final Result > should include suggested follow-ups in final result",
          "state": "passed"
        },
        {
          "name": "should log final result output",
          "fullName": "Orchestrator Graph > Final Result > should log final result output",
          "state": "failed",
          "errors": [
            {
              "message": "expected \"spy\" to be called with arguments: [ Array(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating Orchestrator Graph\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"modelConfiguration\": {\u001b[90m\n\u001b[31m+       \"A1_RETRIEVAL\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A2_JUDGE\": \"openai/gpt-4o (temp=0.1)\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  2nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A1 Retrieval Agent\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"hasPersonas\": false,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  3rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating A1 Retrieval Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  4th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  5th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  6th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  7th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  8th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  9th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  10th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  11th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  12th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  13th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  14th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  15th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  16th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  17th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  18th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  19th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  20th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  21st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  22nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  23rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  24th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  25th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  26th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  27th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  28th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  29th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  30th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  31st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  32nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  33rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  34th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A1 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": false,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 6,\u001b[90m\n\u001b[31m+     \"hasPeerEvidence\": true,\u001b[90m\n\u001b[31m+     \"hasUserEvidence\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  35th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A2 Judge Agent\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  36th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating A2 Judge Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  37th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing user workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  38th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing peer workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  39th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting inefficiency identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  40th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Identifying opportunities\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasInefficiencies\": false,\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowName\": \"research workflow pattern\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  41st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting opportunity identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  42nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Peer diagnostics complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"efficiencyScore\": 100,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  43rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  44th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"errorCount\": 0,\u001b[90m\n\u001b[31m+     \"passed\": true,\u001b[90m\n\u001b[31m+     \"warningCount\": 1,\u001b[90m\n\u001b[31m+     \"wasAutoFixed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  45th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": true,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 5,\u001b[90m\n\u001b[31m+     \"hasPeerDiagnostics\": true,\u001b[90m\n\u001b[31m+     \"hasUserDiagnostics\": false,\u001b[90m\n\u001b[31m+     \"peerEfficiency\": 100,\u001b[90m\n\u001b[31m+     \"userEfficiency\": undefined,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  46th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 Opportunity Debug\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencies\": [],\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"opportunities\": [],\u001b[90m\n\u001b[31m+     \"opportunityCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  47th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Making combined routing decision\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  48th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Routing decision made\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"reasons\": [\u001b[90m\n\u001b[31m+       \"User data available for feature discovery analysis (PRIORITY)\",\u001b[90m\n\u001b[31m+       \"Peer data available (1 workflows)\",\u001b[90m\n\u001b[31m+       \"Web search as fallback (only 0 user analysis results)\",\u001b[90m\n\u001b[31m+       \"User data: 0 workflows, 1 sessions\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  49th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Executing downstream agents IN PARALLEL\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"modelConfig\": {\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  50th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  51st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting web search for user query (parallel with agents)\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  52nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: All downstream agents + web search + feature adoption completed in parallel\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentCount\": 2,\u001b[90m\n\u001b[31m+     \"agentNames\": [\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"hasWebSearchResult\": false,\u001b[90m\n\u001b[31m+     \"parallelDurationMs\": 378,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  53rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Merging results and applying thresholds\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  54th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Available optimization plans\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"companyBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"companyPlanExists\": false,\u001b[90m\n\u001b[31m+     \"peerBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"peerPlanExists\": true,\u001b[90m\n\u001b[31m+     \"webBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"webPlanExists\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  55th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Plans after filtering nulls\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"planCount\": 2,\u001b[90m\n\u001b[31m+     \"totalBlocksBeforeMerge\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  56th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating user query answer\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  57th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  58th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting user query answer LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  59th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  60th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Query type detected\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasWorkflowContext\": false,\u001b[90m\n\u001b[31m+     \"isKnowledgeQuery\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  61st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting follow-up questions LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  62nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Follow-up questions generated\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"attempts\": 2,\u001b[90m\n\u001b[31m+     \"count\": 0,\u001b[90m\n\u001b[31m+     \"questions\": [],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  63rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Using fallback follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  64th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Finalization complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"answerGenerationMs\": 107,\u001b[90m\n\u001b[31m+     \"blockCount\": 0,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 108,\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"followUpGenerationMs\": 1,\u001b[90m\n\u001b[31m+     \"passesThreshold\": false,\u001b[90m\n\u001b[31m+     \"totalTimeSaved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m64\u001b[22m\n\u001b[39m",
              "stack": "AssertionError: expected \"spy\" to be called with arguments: [ Array(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating Orchestrator Graph\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"modelConfiguration\": {\u001b[90m\n\u001b[31m+       \"A1_RETRIEVAL\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A2_JUDGE\": \"openai/gpt-4o (temp=0.1)\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  2nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A1 Retrieval Agent\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"hasPersonas\": false,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  3rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating A1 Retrieval Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  4th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  5th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  6th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  7th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  8th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  9th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  10th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  11th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  12th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  13th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  14th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  15th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  16th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  17th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  18th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  19th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  20th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  21st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  22nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  23rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  24th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  25th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  26th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  27th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  28th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  29th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  30th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  31st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  32nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  33rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  34th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A1 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": false,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 6,\u001b[90m\n\u001b[31m+     \"hasPeerEvidence\": true,\u001b[90m\n\u001b[31m+     \"hasUserEvidence\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  35th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A2 Judge Agent\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  36th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating A2 Judge Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  37th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing user workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  38th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing peer workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  39th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting inefficiency identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  40th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Identifying opportunities\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasInefficiencies\": false,\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowName\": \"research workflow pattern\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  41st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting opportunity identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  42nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Peer diagnostics complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"efficiencyScore\": 100,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  43rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  44th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"errorCount\": 0,\u001b[90m\n\u001b[31m+     \"passed\": true,\u001b[90m\n\u001b[31m+     \"warningCount\": 1,\u001b[90m\n\u001b[31m+     \"wasAutoFixed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  45th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": true,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 5,\u001b[90m\n\u001b[31m+     \"hasPeerDiagnostics\": true,\u001b[90m\n\u001b[31m+     \"hasUserDiagnostics\": false,\u001b[90m\n\u001b[31m+     \"peerEfficiency\": 100,\u001b[90m\n\u001b[31m+     \"userEfficiency\": undefined,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  46th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 Opportunity Debug\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencies\": [],\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"opportunities\": [],\u001b[90m\n\u001b[31m+     \"opportunityCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  47th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Making combined routing decision\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  48th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Routing decision made\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"reasons\": [\u001b[90m\n\u001b[31m+       \"User data available for feature discovery analysis (PRIORITY)\",\u001b[90m\n\u001b[31m+       \"Peer data available (1 workflows)\",\u001b[90m\n\u001b[31m+       \"Web search as fallback (only 0 user analysis results)\",\u001b[90m\n\u001b[31m+       \"User data: 0 workflows, 1 sessions\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  49th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Executing downstream agents IN PARALLEL\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"modelConfig\": {\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  50th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  51st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting web search for user query (parallel with agents)\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  52nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: All downstream agents + web search + feature adoption completed in parallel\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentCount\": 2,\u001b[90m\n\u001b[31m+     \"agentNames\": [\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"hasWebSearchResult\": false,\u001b[90m\n\u001b[31m+     \"parallelDurationMs\": 378,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  53rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Merging results and applying thresholds\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  54th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Available optimization plans\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"companyBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"companyPlanExists\": false,\u001b[90m\n\u001b[31m+     \"peerBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"peerPlanExists\": true,\u001b[90m\n\u001b[31m+     \"webBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"webPlanExists\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  55th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Plans after filtering nulls\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"planCount\": 2,\u001b[90m\n\u001b[31m+     \"totalBlocksBeforeMerge\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  56th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating user query answer\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  57th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  58th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting user query answer LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  59th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  60th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Query type detected\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasWorkflowContext\": false,\u001b[90m\n\u001b[31m+     \"isKnowledgeQuery\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  61st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting follow-up questions LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  62nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Follow-up questions generated\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"attempts\": 2,\u001b[90m\n\u001b[31m+     \"count\": 0,\u001b[90m\n\u001b[31m+     \"questions\": [],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  63rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Using fallback follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  64th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Finalization complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"answerGenerationMs\": 107,\u001b[90m\n\u001b[31m+     \"blockCount\": 0,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 108,\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"followUpGenerationMs\": 1,\u001b[90m\n\u001b[31m+     \"passesThreshold\": false,\u001b[90m\n\u001b[31m+     \"totalTimeSaved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m64\u001b[22m\n\u001b[39m\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1355:10)\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/chai@5.3.3/node_modules/chai/index.js:1686:25)\n    at /Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts:501:31\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"
            },
            {
              "message": "expected \"spy\" to be called with arguments: [ Array(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating Orchestrator Graph\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"modelConfiguration\": {\u001b[90m\n\u001b[31m+       \"A1_RETRIEVAL\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A2_JUDGE\": \"openai/gpt-4o (temp=0.1)\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  2nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A1 Retrieval Agent\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"hasPersonas\": false,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  3rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating A1 Retrieval Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  4th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  5th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  6th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  7th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  8th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  9th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  10th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  11th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  12th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  13th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  14th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  15th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  16th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  17th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  18th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  19th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  20th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  21st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  22nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  23rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  24th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  25th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  26th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  27th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  28th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  29th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  30th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  31st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  32nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  33rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  34th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A1 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": false,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 16,\u001b[90m\n\u001b[31m+     \"hasPeerEvidence\": true,\u001b[90m\n\u001b[31m+     \"hasUserEvidence\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  35th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A2 Judge Agent\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  36th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating A2 Judge Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  37th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing user workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  38th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing peer workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  39th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting inefficiency identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  40th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Identifying opportunities\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasInefficiencies\": false,\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowName\": \"research workflow pattern\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  41st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting opportunity identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  42nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Peer diagnostics complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"efficiencyScore\": 100,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  43rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  44th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"errorCount\": 0,\u001b[90m\n\u001b[31m+     \"passed\": true,\u001b[90m\n\u001b[31m+     \"warningCount\": 1,\u001b[90m\n\u001b[31m+     \"wasAutoFixed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  45th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": true,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 3,\u001b[90m\n\u001b[31m+     \"hasPeerDiagnostics\": true,\u001b[90m\n\u001b[31m+     \"hasUserDiagnostics\": false,\u001b[90m\n\u001b[31m+     \"peerEfficiency\": 100,\u001b[90m\n\u001b[31m+     \"userEfficiency\": undefined,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  46th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 Opportunity Debug\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencies\": [],\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"opportunities\": [],\u001b[90m\n\u001b[31m+     \"opportunityCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  47th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Making combined routing decision\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  48th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Routing decision made\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"reasons\": [\u001b[90m\n\u001b[31m+       \"User data available for feature discovery analysis (PRIORITY)\",\u001b[90m\n\u001b[31m+       \"Peer data available (1 workflows)\",\u001b[90m\n\u001b[31m+       \"Web search as fallback (only 0 user analysis results)\",\u001b[90m\n\u001b[31m+       \"User data: 0 workflows, 1 sessions\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  49th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Executing downstream agents IN PARALLEL\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"modelConfig\": {\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  50th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  51st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting web search for user query (parallel with agents)\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  52nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: All downstream agents + web search + feature adoption completed in parallel\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentCount\": 2,\u001b[90m\n\u001b[31m+     \"agentNames\": [\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"hasWebSearchResult\": false,\u001b[90m\n\u001b[31m+     \"parallelDurationMs\": 129,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  53rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Merging results and applying thresholds\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  54th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Available optimization plans\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"companyBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"companyPlanExists\": false,\u001b[90m\n\u001b[31m+     \"peerBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"peerPlanExists\": true,\u001b[90m\n\u001b[31m+     \"webBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"webPlanExists\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  55th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Plans after filtering nulls\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"planCount\": 2,\u001b[90m\n\u001b[31m+     \"totalBlocksBeforeMerge\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  56th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating user query answer\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  57th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  58th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting user query answer LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  59th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  60th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Query type detected\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasWorkflowContext\": false,\u001b[90m\n\u001b[31m+     \"isKnowledgeQuery\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  61st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting follow-up questions LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  62nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Follow-up questions generated\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"attempts\": 2,\u001b[90m\n\u001b[31m+     \"count\": 0,\u001b[90m\n\u001b[31m+     \"questions\": [],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  63rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Using fallback follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  64th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Finalization complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"answerGenerationMs\": 126,\u001b[90m\n\u001b[31m+     \"blockCount\": 0,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 127,\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"followUpGenerationMs\": 1,\u001b[90m\n\u001b[31m+     \"passesThreshold\": false,\u001b[90m\n\u001b[31m+     \"totalTimeSaved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m64\u001b[22m\n\u001b[39m",
              "stack": "AssertionError: expected \"spy\" to be called with arguments: [ Array(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating Orchestrator Graph\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"modelConfiguration\": {\u001b[90m\n\u001b[31m+       \"A1_RETRIEVAL\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A2_JUDGE\": \"openai/gpt-4o (temp=0.1)\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  2nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A1 Retrieval Agent\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"hasPersonas\": false,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  3rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating A1 Retrieval Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  4th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  5th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  6th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  7th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  8th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  9th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  10th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  11th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  12th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  13th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  14th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  15th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  16th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  17th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  18th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  19th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  20th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  21st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  22nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  23rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": true,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  24th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving user evidence via NLQ\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filterNoise\": true,\u001b[90m\n\u001b[31m+     \"nodeId\": null,\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+     \"queryClassification\": {\u001b[90m\n\u001b[31m+       \"filters\": {},\u001b[90m\n\u001b[31m+       \"intent\": \"OPTIMIZATION\",\u001b[90m\n\u001b[31m+       \"maxResults\": 500,\u001b[90m\n\u001b[31m+       \"scope\": \"HOLISTIC\",\u001b[90m\n\u001b[31m+       \"specificity\": \"BROAD\",\u001b[90m\n\u001b[31m+       \"useSemanticSearch\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+     \"userId\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  25th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Fetched chapter data for sessions\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionsWithChapters\": 0,\u001b[90m\n\u001b[31m+     \"totalSessions\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  26th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Transformed NLQ to evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"entityCount\": 0,\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"totalStepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowSamples\": [\u001b[90m\n\u001b[31m+       {\u001b[90m\n\u001b[31m+         \"hasStepDescriptions\": false,\u001b[90m\n\u001b[31m+         \"stepCount\": 0,\u001b[90m\n\u001b[31m+         \"summary\": \"Test\",\u001b[90m\n\u001b[31m+         \"title\": \"Test\",\u001b[90m\n\u001b[31m+         \"workflowId\": \"wf-s1\",\u001b[90m\n\u001b[31m+       },\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  27th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise analysis before filtering\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"isHighNoise\": false,\u001b[90m\n\u001b[31m+     \"noiseByApp\": {},\u001b[90m\n\u001b[31m+     \"noisePercentage\": \"0.0\",\u001b[90m\n\u001b[31m+     \"noiseSteps\": 0,\u001b[90m\n\u001b[31m+     \"totalSteps\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  28th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Noise filtered from evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"filteredWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"originalWorkflows\": 0,\u001b[90m\n\u001b[31m+     \"stepsRemoved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  29th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: User evidence retrieved\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"sessionCount\": 1,\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  30th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Retrieving peer evidence from platform\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  31st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Using cached peer evidence\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"cacheHit\": true,\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  32nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  33rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A1: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"issueCount\": 2,\u001b[90m\n\u001b[31m+     \"passed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  34th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A1 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": false,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 16,\u001b[90m\n\u001b[31m+     \"hasPeerEvidence\": true,\u001b[90m\n\u001b[31m+     \"hasUserEvidence\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  35th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting A2 Judge Agent\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  36th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Creating A2 Judge Graph\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  37th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing user workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  38th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Diagnosing peer workflows\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"workflowCount\": 1,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  39th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting inefficiency identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"stepCount\": 1,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  40th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Identifying opportunities\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasInefficiencies\": false,\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowName\": \"research workflow pattern\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  41st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Starting opportunity identification LLM call\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"workflowId\": \"peer-wf-peer-hash-1\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  42nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Peer diagnostics complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"efficiencyScore\": 100,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  43rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Running critique loop\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  44th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"A2: Critique complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"canRetry\": false,\u001b[90m\n\u001b[31m+     \"errorCount\": 0,\u001b[90m\n\u001b[31m+     \"passed\": true,\u001b[90m\n\u001b[31m+     \"warningCount\": 1,\u001b[90m\n\u001b[31m+     \"wasAutoFixed\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  45th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"critiquePassed\": true,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 3,\u001b[90m\n\u001b[31m+     \"hasPeerDiagnostics\": true,\u001b[90m\n\u001b[31m+     \"hasUserDiagnostics\": false,\u001b[90m\n\u001b[31m+     \"peerEfficiency\": 100,\u001b[90m\n\u001b[31m+     \"userEfficiency\": undefined,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  46th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: A2 Opportunity Debug\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"inefficiencies\": [],\u001b[90m\n\u001b[31m+     \"inefficiencyCount\": 0,\u001b[90m\n\u001b[31m+     \"opportunities\": [],\u001b[90m\n\u001b[31m+     \"opportunityCount\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  47th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Making combined routing decision\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  48th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Routing decision made\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"reasons\": [\u001b[90m\n\u001b[31m+       \"User data available for feature discovery analysis (PRIORITY)\",\u001b[90m\n\u001b[31m+       \"Peer data available (1 workflows)\",\u001b[90m\n\u001b[31m+       \"Web search as fallback (only 0 user analysis results)\",\u001b[90m\n\u001b[31m+       \"User data: 0 workflows, 1 sessions\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  49th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Executing downstream agents IN PARALLEL\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentsToRun\": [\u001b[90m\n\u001b[31m+       \"A5_FEATURE_ADOPTION\",\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"modelConfig\": {\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_COMPANY\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+       \"A4_WEB\": \"google/gemini-2.5-flash (temp=0.3)\",\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  50th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  51st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting web search for user query (parallel with agents)\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  52nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: All downstream agents + web search + feature adoption completed in parallel\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"agentCount\": 2,\u001b[90m\n\u001b[31m+     \"agentNames\": [\u001b[90m\n\u001b[31m+       \"A3_COMPARATOR\",\u001b[90m\n\u001b[31m+       \"A4_WEB\",\u001b[90m\n\u001b[31m+     ],\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"hasWebSearchResult\": false,\u001b[90m\n\u001b[31m+     \"parallelDurationMs\": 129,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  53rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Merging results and applying thresholds\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  54th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Available optimization plans\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"companyBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"companyPlanExists\": false,\u001b[90m\n\u001b[31m+     \"peerBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"peerPlanExists\": true,\u001b[90m\n\u001b[31m+     \"webBlockCount\": 0,\u001b[90m\n\u001b[31m+     \"webPlanExists\": true,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  55th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Plans after filtering nulls\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"planCount\": 2,\u001b[90m\n\u001b[31m+     \"totalBlocksBeforeMerge\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  56th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating user query answer\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  57th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Searching web for query context\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"query\": \"How can I improve my workflow?\",\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  58th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting user query answer LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  59th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Generating follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  60th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Query type detected\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"hasWorkflowContext\": false,\u001b[90m\n\u001b[31m+     \"isKnowledgeQuery\": false,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  61st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Starting follow-up questions LLM call\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  62nd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Follow-up questions generated\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"attempts\": 2,\u001b[90m\n\u001b[31m+     \"count\": 0,\u001b[90m\n\u001b[31m+     \"questions\": [],\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  63rd spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Using fallback follow-up questions\",\u001b[90m\n\u001b[2m  ]\u001b[22m\n\n\u001b[1m  64th spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   \"=== ORCHESTRATOR OUTPUT (Final Result) ===\",\u001b[90m\n\u001b[31m+   \"Orchestrator: Finalization complete\",\u001b[90m\n\u001b[31m+   {\u001b[90m\n\u001b[31m+     \"answerGenerationMs\": 126,\u001b[90m\n\u001b[31m+     \"blockCount\": 0,\u001b[90m\n\u001b[31m+     \"elapsedMs\": 127,\u001b[90m\n\u001b[31m+     \"featureAdoptionTipCount\": 0,\u001b[90m\n\u001b[31m+     \"followUpGenerationMs\": 1,\u001b[90m\n\u001b[31m+     \"passesThreshold\": false,\u001b[90m\n\u001b[31m+     \"totalTimeSaved\": 0,\u001b[90m\n\u001b[31m+   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m64\u001b[22m\n\u001b[39m\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1355:10)\n    at Proxy.<anonymous> (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+expect@3.2.4/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/chai@5.3.3/node_modules/chai/index.js:1686:25)\n    at /Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/packages/server/src/services/insight-generation/__tests__/orchestrator-graph.test.ts:501:31\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at file:///Users/mrunmayeerane/Desktop/Light-House/lighthouse-journey-canvas/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"
            }
          ]
        },
        {
          "name": "should track progress through stages",
          "fullName": "Orchestrator Graph > Progress Tracking > should track progress through stages",
          "state": "passed"
        },
        {
          "name": "should handle A1 failure gracefully",
          "fullName": "Orchestrator Graph > Error Handling > should handle A1 failure gracefully",
          "state": "passed"
        }
      ]
    }
  ],
  "unhandledErrors": [],
  "reason": "failed"
}